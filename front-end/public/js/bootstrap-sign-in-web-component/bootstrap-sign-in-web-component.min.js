/**
 * This content is released under the MIT License (MIT)
 *
 * Copyright (c) 2018, canchito-dev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 * @author 		Jose Carlos Mendoza Prego
 * @copyright	Copyright (c) 2018, canchito-dev (http://www.canchito-dev.com)
 * @license		http://opensource.org/licenses/MIT	MIT License
 * @link		https://github.com/canchito-dev/canchito-workflow-manager
 * @link		http://canchito-dev/projects/bootstrap-sign-in-web-component
 **/
!function(t){"use strict";var i="bs.bootsignin",o=function(i,e){this.$element=t(i),this.$origin=this.$element.clone(),this.options=t.extend(!0,{},o.defaults,this.$element.data(),e);var a=this,n={url:this.options.template,data:{},success:function(i,o,e){var n=t(i);if(a.$element.wrapInner(n),a.options.showPasswordToggler){var s=n.find('input[type="password"]');a.initPasswordToggler(s,a.options.passwordToggler)}if(a.options.validateForm){var r=n.find("form");a.initForm(r,a.options.formErrorMessages)}},dataType:"html"};t.get(n)};o.defaults={version:"1.0.0",showPasswordToggler:!1,passwordToggler:{append:"append",iconPrefix:"fas",iconShow:"fa-eye",iconHide:"fa-eye-slash",tooltip:"Show/Hide password"},ajax:!0,ajaxSettings:{type:"POST",async:!0,contentType:"application/x-www-form-urlencoded",dataType:"json",beforeSend:function(t,i){return{jqXHR:t,settings:i}},error:function(t,i,o){return{jqXHR:t,textStatus:i,errorThrown:o}},complete:function(t,i){return{jqXHR:t,textStatus:i}},success:function(t,i,o){return{response:t,textStatus:i,jqXHR:o}}},template:"template.html",validateForm:!1,formErrorMessages:{email:"Empty or incorrect email",password:"Empty or incorrect password"},prepareFormData:function(t){return{}}},o.prototype.initPasswordToggler=function(i,o){var e=t(['<div class="input-group-'+o.append+'" data-visible="false"><span class="input-group-text" title="'+o.tooltip+'" style="cursor: pointer;"><i class="'+o.iconPrefix+" "+o.iconShow+'" aria-hidden="true"></i></span></div>'].join("\n"));e.off("click").on("click",t.proxy(function(){this.togglePassword(i,e,o)},this)),i.wrap('<div class="input-group"></div>'),e.insertAfter(i)},o.prototype.togglePassword=function(t,i,o){i.data("visible")?(t.attr("type","password"),i.find("i").removeClass(o.iconHide).addClass(o.iconShow)):(t.attr("type","text"),i.find("i").removeClass(o.iconShow).addClass(o.iconHide)),i.data("visible",!i.data("visible"))},o.prototype.initForm=function(i,o){var e=void 0;for(var a in o){e=t(['<div class="invalid-feedback">'+o[a]+"</div>"].join("\n"));var n=i.find('input[type="'+a+'"]');n.parent().hasClass("input-group")&&(n=n.parent().find("[class^=input-group-append]")),e.insertAfter(n)}i.addClass("needs-validation"),i.attr("novalidate","novalidate"),i.off("submit").on("submit",t.proxy(function(o){if(o.preventDefault(),o.stopPropagation(),!1===i[0].checkValidity())i.addClass("was-validated");else if(this.options.ajax){var e=this.options.prepareFormData(i),a=t.extend(!0,{},this.options.ajaxSettings,{data:e});t.ajax(a)}},this))},t.fn.bootsignin=function(e){return this.each(function(a){var n=t(this),s=n.data(i);s||n.data(i,s=new o(this,e))})},t(function(){t('[data-toogle="bootsignin"]').bootsignin()})}(jQuery);